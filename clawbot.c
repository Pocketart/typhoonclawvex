#pragma config(Motor,  port1,           right,         tmotorVex393_HBridge, openLoop)
#pragma config(Motor,  port6,           claw,          tmotorVex393_MC29, openLoop)
#pragma config(Motor,  port7,           arm,           tmotorVex393_MC29, openLoop)
#pragma config(Motor,  port10,          left,          tmotorVex393_HBridge, openLoop)
//*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//

void movewheel2control(){//motor controlled by two joystick
	motor[port1]=vexRT[Ch2];//setting speed of right motor
	motor[port10]=-vexRT[Ch3];//setting speed of left motor
}
void movewheel(){//motor controlled by one joystick
	float y = vexRT[Ch2]/2;//get joystick value
	float x = vexRT[Ch1]/2;//get joystick value
	float left_motor;//variable for speed of left motor
	float right_motor;//variable for speed of right motor
	float power, st;//power for speed to distribute, st for steering
	power = sqrt(x*x+y*y);//calculating power
	if(y>=0&&power!=0){//check joystick position of y
		st = x * 100/power;//set value for st
		if(x>=0){//check joystick position of x
			left_motor = power;//set speed
			right_motor = (1-0.02*st)*power;
		}
		else{
			right_motor = power;
			left_motor = (1+0.02*st)*power;
		}
	}
	if(y<=0&&power!=0){
		power*=-1;
		st = x * 100/power;
		if(x>=0){
			left_motor = (1+0.02*st)*power;
			right_motor = power;
		}
		else{
			right_motor = (1-0.02*st)*power;
			left_motor = power;
		}
	}
	if(x==0&&y==0){
		motor[port10] = 0;
		motor[port1] = 0;
	}
	motor[port10] = -left_motor;//set speed for left motor
	motor[port1] = right_motor;//set speed for right motor
}

void moveclaw(){
	if(vexRT[Btn5U] == 1){//check of button 5U is pressed
		motor[port7] = 100;//lift arm if it does not exceed limit
	}
	else if(vexRT[Btn5D] == 1){//check of button 5D is pressed
		motor[port7] = -30;//lower arm
	}
	else if(vexRT(Btn6U) == 1){//check of button 6U is pressed
		motor[port6] = 100;//open claw
	}
	else if(vexRT(Btn6D) == 1){//check of button 6D is pressed
		motor[port6] = -100;//close claw
	}else{
		motor[port6] = 5;//assure claw is shut tightly
		motor[port7] = 15;//prevent arm from falling down due to gravity
	}
}

void lineFollow(float motor1, float motor10, float difference, float a){
	if(sensorvalue(armstop)==1){//button for safety
			difference = sensorValue(light_right)-sensorValue(light_left);//difference between two light sensor
			motor[port1] = motor1+difference*a;//setting speed of motor, check if robot should turn
			motor[port10] = motor10+difference*a;//setting speed of motor, check if robot should turn
	}else{
			motor[port1] = 0;//stop if button is not pressed
			motor[port10] = 0;//stop if button is not pressed
	}
}

void testStraight(){
	motor[port1]=vexRT[ch2];
	motor[port10]=-vexRT[ch2];
}

task main(){
	// variable initializing for line following mechanism
	/*
	float motor1 = 25;//initializing right motor speed
	float motor10 = -25;//initializing left motor speed
	float difference = 0;//difference between two sensor values
	float a = -0.03325//adjusting constant
	*/
	while(true){
		moveclaw();
		movewheel();
	}
}
